===报表===


====明确需求====

1. 统计范围，是月报表还是合计报表

2. 查询条件，是日期范围还是需要按类别，线路等条件

3. 是否需要输出全部仪表，包括没有记录

4. 作用于原始数据还是当前数据

5. 排序等其它条件

以遵义报表为例，我们可以明确


月报表，查询条件是按月，仅作用有数据的报表，按类别和电压等级排序，同类单元格合并，计算分类合格率和综合合格率


==== 按用户所在公司账户数据过滤====


====建议=====

1. 不建议在sql 中计算超限率和合格率

如果在sql 中计算，则必须判断运行总时为零的情况

月报表时

{{{ (case when total_time=0 then 0 else (total_time-hi_time-low_time)/total_time end ) as pass_rate

}}}

或汇总时

{{{ case when sum(total_time)=0 then 0 else (sum(total_time)-sum(hi_time)-sum(low_time))/sum(total_time end ) as pass_rate

}}}




